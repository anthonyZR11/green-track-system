<ng-container *ngIf="!isAuthRoute(); else authBlock">
  <div class="d-flex vh-100 overflow-hidden">
    <!-- Sidebar -->
    <nav class="sidebar flex-shrink-0 d-flex flex-column shadow">
      <div class="logo-section flex-shrink-0">
        <h4 class="text-white mb-0 d-flex align-items-center gap-2">
          <i class="bi bi-box-seam text-primary"></i> Green Track
        </h4>
      </div>

      <div class="flex-grow-1 overflow-auto py-2">
        <ul class="nav flex-column">
          <li class="nav-item">
            <a class="nav-link" routerLink="/home" routerLinkActive="active">
              <i class="bi bi-house"></i> Home
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" routerLink="/equipos" routerLinkActive="active">
              <i class="bi bi-laptop"></i> Equipos
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" routerLink="/prestamos" routerLinkActive="active">
              <i class="bi bi-arrow-left-right"></i> Préstamos
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" routerLink="/graficos" routerLinkActive="active">
              <i class="bi bi-pie-chart"></i> Gráficos
            </a>
          </li>
          <li class="nav-item" *ngIf="isAdmin()">
            <a class="nav-link" routerLink="/usuarios" routerLinkActive="active">
              <i class="bi bi-people"></i> Usuarios
            </a>
          </li>
        </ul>
      </div>

      <div class="p-3 border-top border-secondary border-opacity-25">
        <button (click)="logout()"
          class="btn btn-outline-danger w-100 d-flex align-items-center justify-content-center gap-2">
          <i class="bi bi-box-arrow-right"></i> Salir
        </button>
      </div>
    </nav>

    <!-- Main Content Area -->
    <div class="flex-grow-1 d-flex flex-column overflow-hidden">
      <!-- Header -->
      <header class="main-header shadow-sm">
        <div class="ms-auto user-badge">
          <div class="d-flex flex-column text-end align-items-end">
            <span class="fw-bold text-dark lh-1 small">{{ username }}</span>
            <span class="role-tag mt-1">{{ role }}</span>
          </div>
          <div class="user-avatar text-uppercase">
            {{ username.substring(0, 1) || 'U' }}
          </div>
        </div>
      </header>

      <!-- Page Content -->
      <main class="flex-grow-1 p-4 overflow-auto bg-light bg-opacity-50">
        <div class="container-fluid p-0">
          <router-outlet></router-outlet>
        </div>
      </main>
    </div>
  </div>
</ng-container>
<ng-template #authBlock>
  <!-- Aquí solo el router-outlet -->
  <router-outlet></router-outlet>
</ng-template>